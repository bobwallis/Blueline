{% if doveids is defined and doveids.length > 1 %}
	{% for doveid in doveids %}
		{% render path('Blueline_Towers_view', {'doveid':doveid, 'snippet':true}) with {}, {'standalone':true} %}
	{% endfor %}
{% else %}
{% from 'BluelineCCCBRDataBundle:Macros:header.html.twig' import header %}
<section class="tower">
	{{ header( { 'title': tower.place, 'title2': (tower.dedication != 'Unknown')? tower.dedication : null }, list( [tower.county, tower.country],', ',', ' ), { 'id': 'tower_'~id~'_tabBar', 'tabs': [
		{ 'title': 'Details', 'content': 'tower_details_'~id },
		{ 'title': 'Map', 'content': 'tower_map_'~id, 'className': 'normal_hide' },
		{ 'title': 'Methods First Pealed', 'content': 'tower_peals_'~id }
	] } ) }}
	<div id="tower_map_{{ id }}" class="staticMap">
		<noscript><h2>Map</h2></noscript>
		<img width="310px" height="380px" src="http://maps.google.com/maps/api/staticmap?format=png&amp;scale=2&amp;size=310x380&amp;maptype=roadmap&amp;sensor=false&amp;zoom=14&amp;center={{ tower.latitude }},{{ tower.longitude }}&amp;markers=size:small|color:red|{{ tower.latitude }},{{ tower.longitude }}" />
	</div>
	<script>
	{% autoescape false %}
	//<![CDATA[
		require( ['ui/TowerMap'], function( TowerMap ) {
			TowerMap.set( {
				zoom: 15,
				center: new google.maps.LatLng( {{ tower.latitude }}, {{ tower.longitude }} )
			} );
		} );
	{% endautoescape %}
	//]]>
	</script>
	<div id="tower_details_{{ id }}" class="details">
		<noscript><h2>Details</h2></noscript>
		<table>
			<tr>
				<th>Bells:</th>
				<td><strong>{{ tower.bells }}</strong>{% if tower.unringable %} (Unringable){% endif %}</td>
			</tr>
			<tr>
				<th>Tenor:</th>
				<td><strong>{{ (tower.weightApprox?'~':'')~tower.weightText }}</strong> in {{ tower.note|addAccidentals }}{{ tower.hz is not empty? ' ('~tower.hz~'Hz)' : '' }}</td>
			</tr>
{% if tower.affiliations is not empty %}
			<tr>
				<th>Affiliations:</th>
				<td>{% for association in tower.affiliations %}{% if not loop.first %}{{ loop.last? ' and ' : ', ' }}{% endif %}<a href="{{ path( 'Blueline_Associations_view', { 'abbreviation': association.abbreviation } ) }}">{{ association.name }}</a>{% endfor %}</td>
			</tr>
{% endif %}
			<tr>
				<th>Diocese:</th>
				<td>{{ tower.diocese }}</td>
			</tr>
{% if tower.postcode is not empty %}
			<tr>
{% if tower.country in ['USA'] %}
				<th>Zip&nbsp;Code:</th>
{% else %}
				<th>Postcode:</th>
{% endif %}
				<td>{{ tower.postcode }}</td>
			</tr>
{% endif %}
{% if tower.gridReference is not empty %}
			<tr>
				<th>Grid&nbsp;Reference:</th>
				<td>{{ tower.gridReference }}</td>
			</tr>
{% endif %}
{% if tower.toilet or tower.simulator %}
			<tr>
				<th>Facilities:</th>
				<td>
					{% if tower.toilet %}Toilet available.<br />{% endif %}
					{% if tower.simulator %}Has a simulator.<br />{% endif %}
				</td>
			</tr>
{% endif %}
			<tr>
				<th>Information:</th>
				<td>
					{% if tower.extraInfo is not empty %}{{ tower.extraInfo }}<br />{% endif %}
					{% if tower.overhaulYear %}Overhauled in {{ tower.overhaulYear }}{{ tower.contractor is not empty? ' by '~tower.contractor : '' }}.<br />{% endif %}
					{% if tower.tuned %}Tuned in {{ tower.tuned }}.<br />{% endif %}
					{% if tower.practiceNight > 0 or tower.practiceNotes is not empty %}
					Practice: {{ dayToString( tower.practiceNight ) }}{{ tower.practiceStart is not empty?', '~tower.practiceStart : '' }}{{ tower.practiceNotes is not empty? ' - '~tower.practiceNotes : '' }}<br />
					{% endif %}
					{% if tower.webPage is not empty %}<a href="http://{{ tower.webPage }}" class="external">Tower Website</a>, {% endif %}<a href="http://dove.cccbr.org.uk/detail.php?DoveID={{ tower.doveid }}&showFrames=true" class="external">Dove Entry</a>
				</td>
			</tr>
		</table>
		<h3>Nearby Towers:</h3>
		<ol>
{% for tower2 in tower.nearbyTowers|default([]) %}
			<li><a href="{{ path( 'Blueline_Towers_view', {'doveid':tower2.doveid} ) }}">{{ tower2.place}} <small>({{ tower2.dedication }})</small></a> <small>{{ round( tower2.distance, 1 ) }} miles</small></li>
{% else %}
			<li>None</li>
{% endfor %}
		</ol>
	</div>
	<div id="tower_peals_{{ id }}" class="firstPeals">
		<noscript><h2>First Peals</h2></noscript>
		<ol>
			{% for method in tower.firstPealedMethods %}
			<li><a href="{{ path( 'Blueline_Methods_view', { 'title': method.title|replace({' ':'_'}) } ) }}">{{ method.title }}</a> <small>({{ method.firstTowerbellPealDate|date('Y-m-d') }})</small></li>
			{% else %}
			<li>None</li>
			{% endfor %}
		</ol>
	</div>
</section>
{% endif %}
